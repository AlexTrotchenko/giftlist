---
title: Claim Lifecycle
---
stateDiagram-v2
    [*] --> Unclaimed: item shared with recipients

    Unclaimed --> Claimed: claim(item, user)

    Claimed --> Purchased: markPurchased(item, user)
    Claimed --> Unclaimed: unclaim(item, user)
    Claimed --> Unclaimed: release(item)
    Claimed --> [*]: item removed

    Purchased --> Claimed: unmarkPurchased(item, user)
    Purchased --> Unclaimed: unclaim(item, user)
    Purchased --> Unclaimed: release(item)
    Purchased --> [*]: item removed
    Purchased --> [*]: item received & archived

    Unclaimed --> [*]: item removed
    Unclaimed --> [*]: all tags removed

    state "Release Triggers" as triggers {
        T1: Claimer removed from group
        T2: Owner joins claimer's group
        T3: Item untagged from claimer's access
        T4: Group deleted
    }

    note right of Unclaimed
        Any recipient can claim
        First come, first served
    end note

    note right of Claimed
        Locked to one claimer
        Visible to all recipients
        Hidden from owner
    end note

    note right of Purchased
        Claimer marked as purchased
        Other recipients see "Purchased" badge
        Owner still hidden (surprise!)
        Does not auto-expire (unlike unpurchased claims)
    end note

    note left of triggers
        Any of these triggers
        Claim.release(item)
    end note
